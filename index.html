<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SillyTavern 角色卡解析器 - 纯前端版</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎭 SillyTavern 角色卡解析器</h1>
            <p>纯前端版本 - 上传角色卡PNG图片或输入URL链接，解析并查看角色信息</p>
        </div>

        <div class="main-content">
            <div class="upload-section">
                <!-- Tab切换界面 -->
                <div class="tab-container">
                    <div class="tab-buttons" role="tablist" aria-label="选择输入方式">
                        <button class="tab-button active" data-tab="url" role="tab" aria-selected="true" aria-controls="urlTab" id="urlTabButton">🌐 URL链接</button>
                        <button class="tab-button" data-tab="upload" role="tab" aria-selected="false" aria-controls="uploadTab" id="uploadTabButton">📁 文件上传</button>
                    </div>
                    
                <!-- URL输入区域 -->
                    <div class="tab-content active" id="urlTab" role="tabpanel" aria-labelledby="urlTabButton">
                        <div class="url-input-container" style="display: flex; gap: var(--spacing-sm); align-items: center; max-width: 600px; margin: 0 auto;">
                            <input type="url" id="urlInput" placeholder="输入PNG图片链接..." 
                                   style="flex: 1; padding: var(--spacing-md); border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 1rem; outline: none; transition: border-color 0.3s ease;"
                                   onfocus="this.style.borderColor='var(--primary-color)'" 
                                   onblur="this.style.borderColor='var(--border-color)'"
                                   aria-label="输入PNG图片URL链接">
                            <button id="parseUrlButton" class="parse-button" style="margin: 0; padding: var(--spacing-md) var(--spacing-lg); white-space: nowrap;"
                                    aria-label="解析URL链接">
                            🌐 解析链接
                        </button>
                    </div>
                        <p style="margin-top: var(--spacing-sm); color: var(--text-secondary); font-size: 0.9rem;">
                            支持直接输入PNG图片的URL链接进行解析<br>
                            <span style="color: var(--accent-color); font-size: 0.8rem;">
                                💡 Discord链接会自动移除 &format=webp&quality=lossless 参数
                            </span>
                        </p>
                </div>

                <!-- 文件上传区域 -->
                    <div class="tab-content" id="uploadTab" role="tabpanel" aria-labelledby="uploadTabButton">
                        <div class="upload-area" id="uploadArea" role="button" tabindex="0" aria-label="点击选择文件或拖拽PNG图片到此处">
                            <div class="upload-icon" aria-hidden="true">📁</div>
                    <div class="upload-text">点击选择文件或拖拽PNG图片到此处</div>
                    <div class="upload-hint">支持 SillyTavern 角色卡格式 (V2/V3)</div>
                </div>
                        <input type="file" id="fileInput" accept=".png" aria-label="选择PNG文件" />
                
                        <div class="file-info" id="fileInfo" role="status" aria-live="polite">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-size" id="fileSize"></div>
                </div>

                        <button class="parse-button" id="parseButton" disabled aria-label="解析选中的角色卡文件">解析角色卡</button>
                    </div>
                </div>
            </div>

            <div class="result-section" id="resultSection">
                <div class="result-header">
                    <div class="result-title">解析结果</div>
                    <div class="result-status" id="resultStatus"></div>
                </div>
                <div id="resultContent"></div>
            </div>

            <div class="supported-formats">
                <h3>📋 支持的格式</h3>
                <ul class="format-list">
                    <li>SillyTavern V2 格式 (chara_card_v2)</li>
                    <li>SillyTavern V3 格式 (chara_card_v3)</li>
                    <li>PNG 图片格式</li>
                    <li>JPEG/WebP/GIF/BMP 图片格式</li>
                    <li>自动格式转换支持</li>
                    <li>包含角色元数据的图片</li>
                    <li>支持URL链接解析</li>
                    <li>支持本地文件上传</li>
                </ul>
                
                <div style="margin-top: 20px; text-align: center;">
                    <button id="testButton" class="parse-button" style="background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);">
                        🧪 测试解析器
                    </button>
                    <p style="margin-top: 10px; color: #666; font-size: 0.9em;">
                        点击测试按钮查看解析器状态和调试信息
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
